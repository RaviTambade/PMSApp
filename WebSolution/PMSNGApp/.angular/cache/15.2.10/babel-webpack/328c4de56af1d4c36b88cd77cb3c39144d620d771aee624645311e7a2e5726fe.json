{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/time-sheet/services/time-sheet.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../insert-time-sheet-entry/insert-time-sheet-entry.component\";\nimport * as i4 from \"../../popup/popup.component\";\nimport * as i5 from \"../update-timesheet-entry/update-timesheet-entry.component\";\nfunction InsertTimeSheetComponent_ng_template_0_app_insert_time_sheet_entry_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-insert-time-sheet-entry\", 9);\n    i0.ɵɵlistener(\"stateChangeEvent\", function InsertTimeSheetComponent_ng_template_0_app_insert_time_sheet_entry_0_Template_app_insert_time_sheet_entry_stateChangeEvent_0_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.onAddStateChange($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"timeSheetId\", ctx_r10.timeSheet.id);\n  }\n}\nfunction InsertTimeSheetComponent_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, InsertTimeSheetComponent_ng_template_0_app_insert_time_sheet_entry_0_Template, 1, 1, \"app-insert-time-sheet-entry\", 8);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.timeSheet);\n  }\n}\nfunction InsertTimeSheetComponent_ng_template_2_app_update_timesheet_entry_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-update-timesheet-entry\", 11);\n    i0.ɵɵlistener(\"stateChangeEvent\", function InsertTimeSheetComponent_ng_template_2_app_update_timesheet_entry_0_Template_app_update_timesheet_entry_stateChangeEvent_0_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.onUpdateStateChange($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"timeSheetEntry\", ctx_r13.selectedTimeSheetEntrytoUpdate);\n  }\n}\nfunction InsertTimeSheetComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, InsertTimeSheetComponent_ng_template_2_app_update_timesheet_entry_0_Template, 1, 1, \"app-update-timesheet-entry\", 10);\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.selectedTimeSheetEntrytoUpdate);\n  }\n}\nfunction InsertTimeSheetComponent_app_popup_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-popup\", 12);\n    i0.ɵɵlistener(\"closePopup\", function InsertTimeSheetComponent_app_popup_4_Template_app_popup_closePopup_0_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.onCloseAddPopup());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const _r0 = i0.ɵɵreference(1);\n    i0.ɵɵproperty(\"templateToRender\", _r0);\n  }\n}\nfunction InsertTimeSheetComponent_app_popup_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-popup\", 12);\n    i0.ɵɵlistener(\"closePopup\", function InsertTimeSheetComponent_app_popup_5_Template_app_popup_closePopup_0_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.onCloseUpdatePopup());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const _r2 = i0.ɵɵreference(3);\n    i0.ɵɵproperty(\"templateToRender\", _r2);\n  }\n}\nfunction InsertTimeSheetComponent_button_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function InsertTimeSheetComponent_button_14_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.onClickAddTimesheetEntry());\n    });\n    i0.ɵɵtext(1, \" Add \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction InsertTimeSheetComponent_tbody_28_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function InsertTimeSheetComponent_tbody_28_td_12_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const timeSheetEntry_r22 = i0.ɵɵnextContext().$implicit;\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.onClickUpdateTimesheetEntry(timeSheetEntry_r22));\n    });\n    i0.ɵɵtext(2, \"Edit\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction InsertTimeSheetComponent_tbody_28_td_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r30 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function InsertTimeSheetComponent_tbody_28_td_13_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r30);\n      const timeSheetEntry_r22 = i0.ɵɵnextContext().$implicit;\n      const ctx_r28 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r28.onRemoveTimeSheetEntry(timeSheetEntry_r22.id));\n    });\n    i0.ɵɵtext(2, \"Delete\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction InsertTimeSheetComponent_tbody_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tbody\")(1, \"tr\")(2, \"td\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, InsertTimeSheetComponent_tbody_28_td_12_Template, 3, 0, \"td\", 14);\n    i0.ɵɵtemplate(13, InsertTimeSheetComponent_tbody_28_td_13_Template, 3, 0, \"td\", 14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const timeSheetEntry_r22 = ctx.$implicit;\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(timeSheetEntry_r22.workCategory);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(timeSheetEntry_r22.work);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(timeSheetEntry_r22.fromTime);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(timeSheetEntry_r22.toTime);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(timeSheetEntry_r22.durationInHours);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r7.timeSheet == null ? null : ctx_r7.timeSheet.status) == \"inprogress\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r7.timeSheet == null ? null : ctx_r7.timeSheet.status) == \"inprogress\");\n  }\n}\nfunction InsertTimeSheetComponent_button_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r32 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function InsertTimeSheetComponent_button_31_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const ctx_r31 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r31.onSubmit());\n    });\n    i0.ɵɵtext(1, \" submit \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction InsertTimeSheetComponent_button_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r34 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function InsertTimeSheetComponent_button_32_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r34);\n      const ctx_r33 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r33.onRemoveAllTimeSheetEntries(ctx_r33.timeSheet.id));\n    });\n    i0.ɵɵtext(1, \" ClearAll \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport class InsertTimeSheetComponent {\n  constructor(timeSheetSvc) {\n    this.timeSheetSvc = timeSheetSvc;\n    // timeSheetId!: number;\n    // timeSheetEntries: TimeSheetEntry[] = [];\n    this.totalminutes = 0;\n    this.showaddTimesheetEntry = false;\n    this.showupdateTimesheetEntry = false;\n    this.todaysDate = new Date().toISOString().slice(0, 10);\n    this.employeeId = 10;\n  }\n  ngOnInit() {\n    this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\n  }\n  onRemoveTimeSheetEntry(timeSheetEntryId) {\n    this.timeSheetSvc.removeTimeSheetEntry(timeSheetEntryId).subscribe(res => {\n      if (res) {\n        this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\n        console.log('record deleted');\n      }\n    });\n  }\n  onRemoveAllTimeSheetEntries(timeSheetId) {\n    this.timeSheetSvc.removeAllTimeSheetEntries(timeSheetId).subscribe(res => {\n      if (res) {\n        if (this.timeSheet) this.timeSheet.timeSheetEntries = [];\n      }\n    });\n  }\n  onSubmit() {\n    if (this.timeSheet) {\n      let timesheet = {\n        id: this.timeSheet?.id,\n        timeSheetDate: this.timeSheet.timeSheetDate,\n        status: 'Submitted',\n        employeeId: this.timeSheet.employeeId,\n        timeSheetEntries: this.timeSheet.timeSheetEntries,\n        statusChangedDate: this.todaysDate\n      };\n      this.timeSheetSvc.changeTimeSheetStatus(this.timeSheet.id, timesheet).subscribe(res => {\n        alert('timesheet added');\n      });\n    }\n  }\n  onClickAddTimesheetEntry() {\n    this.showaddTimesheetEntry = true;\n  }\n  onCloseAddPopup() {\n    this.showaddTimesheetEntry = false;\n  }\n  onClickUpdateTimesheetEntry(timeSheetEntry) {\n    let newentry = {\n      ...timeSheetEntry\n    };\n    this.selectedTimeSheetEntrytoUpdate = newentry;\n    this.showupdateTimesheetEntry = true;\n  }\n  onCloseUpdatePopup() {\n    this.showupdateTimesheetEntry = false;\n    this.selectedTimeSheetEntrytoUpdate = undefined;\n  }\n  fetchTimeSheetEntries(employeeId, date) {\n    this.timeSheetSvc.getTimeSheet(employeeId, date).subscribe(res => {\n      if (res.id == 0) {\n        this.timeSheetSvc.insertTimeSheet(employeeId, date).subscribe(res => {\n          if (res) {\n            this.fetchTimeSheetEntries(employeeId, date);\n          }\n        });\n        return;\n      }\n      this.totalminutes = 0;\n      this.timeSheet = res;\n      console.log('🚀 ~ this.timeSheetSvc.getTimeSheet ~ timeSheetId:', res.id);\n      this.timeSheet.timeSheetEntries.forEach(entry => {\n        entry = this.timeSheetSvc.getDurationOfWork(entry);\n        this.totalminutes += entry.durationInMinutes;\n      });\n      this.totalminutes = this.timeSheetSvc.convertMinutesintoHours(this.totalminutes);\n      console.log(res);\n    });\n  }\n  onAddStateChange(isupdated) {\n    if (isupdated) {\n      this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\n    }\n    this.showaddTimesheetEntry = false;\n  }\n  onUpdateStateChange(isupdated) {\n    if (isupdated) {\n      this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\n    }\n    this.showupdateTimesheetEntry = false;\n    this.selectedTimeSheetEntrytoUpdate = undefined;\n  }\n  static #_ = this.ɵfac = function InsertTimeSheetComponent_Factory(t) {\n    return new (t || InsertTimeSheetComponent)(i0.ɵɵdirectiveInject(i1.TimeSheetService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: InsertTimeSheetComponent,\n    selectors: [[\"app-insert-time-sheet\"]],\n    decls: 33,\n    vars: 14,\n    consts: [[\"insertTimesheetEnrty\", \"\"], [\"updateTimeSheetEntry\", \"\"], [3, \"templateToRender\", \"closePopup\", 4, \"ngIf\"], [3, \"click\", 4, \"ngIf\"], [1, \"table-bordered\"], [4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"mx-1\", 3, \"click\", 4, \"ngIf\"], [3, \"timeSheetId\", \"stateChangeEvent\", 4, \"ngIf\"], [3, \"timeSheetId\", \"stateChangeEvent\"], [3, \"timeSheetEntry\", \"stateChangeEvent\", 4, \"ngIf\"], [3, \"timeSheetEntry\", \"stateChangeEvent\"], [3, \"templateToRender\", \"closePopup\"], [3, \"click\"], [4, \"ngIf\"], [\"type\", \"submit\", 3, \"click\"], [1, \"mx-1\", 3, \"click\"]],\n    template: function InsertTimeSheetComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, InsertTimeSheetComponent_ng_template_0_Template, 1, 1, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(2, InsertTimeSheetComponent_ng_template_2_Template, 1, 1, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(4, InsertTimeSheetComponent_app_popup_4_Template, 1, 1, \"app-popup\", 2);\n        i0.ɵɵtemplate(5, InsertTimeSheetComponent_app_popup_5_Template, 1, 1, \"app-popup\", 2);\n        i0.ɵɵelementStart(6, \"p\");\n        i0.ɵɵtext(7);\n        i0.ɵɵpipe(8, \"date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"p\");\n        i0.ɵɵtext(10);\n        i0.ɵɵpipe(11, \"titlecase\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"p\");\n        i0.ɵɵtext(13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(14, InsertTimeSheetComponent_button_14_Template, 2, 0, \"button\", 3);\n        i0.ɵɵelementStart(15, \"table\", 4)(16, \"thead\")(17, \"tr\")(18, \"th\");\n        i0.ɵɵtext(19, \"Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"th\");\n        i0.ɵɵtext(21, \"work\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"th\");\n        i0.ɵɵtext(23, \"StartTime\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"th\");\n        i0.ɵɵtext(25, \"EndTime\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"th\");\n        i0.ɵɵtext(27, \"Duration\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(28, InsertTimeSheetComponent_tbody_28_Template, 14, 7, \"tbody\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"p\");\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(31, InsertTimeSheetComponent_button_31_Template, 2, 0, \"button\", 6);\n        i0.ɵɵtemplate(32, InsertTimeSheetComponent_button_32_Template, 2, 0, \"button\", 7);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.showaddTimesheetEntry);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showupdateTimesheetEntry);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" Date : \", i0.ɵɵpipeBind1(8, 10, ctx.timeSheet == null ? null : ctx.timeSheet.timeSheetDate), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\" Status:\", i0.ɵɵpipeBind1(11, 12, ctx.timeSheet == null ? null : ctx.timeSheet.status), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\" Employee Name:\", ctx.timeSheet == null ? null : ctx.timeSheet.employeeName, \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", (ctx.timeSheet == null ? null : ctx.timeSheet.status) == \"inprogress\");\n        i0.ɵɵadvance(14);\n        i0.ɵɵproperty(\"ngForOf\", ctx.timeSheet == null ? null : ctx.timeSheet.timeSheetEntries);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Total Hours : \", ctx.totalminutes, \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", (ctx.timeSheet == null ? null : ctx.timeSheet.status) == \"inprogress\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", (ctx.timeSheet == null ? null : ctx.timeSheet.status) == \"inprogress \" && ctx.timeSheet);\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf, i3.InsertTimeSheetEntryComponent, i4.PopupComponent, i5.UpdateTimesheetEntryComponent, i2.TitleCasePipe, i2.DatePipe],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","InsertTimeSheetComponent","constructor","timeSheetSvc","Date","toISOString","slice","ngOnInit","fetchTimeSheetEntries","employeeId","todaysDate","onRemoveTimeSheetEntry","timeSheetEntryId","removeTimeSheetEntry","subscribe","res","console","log","onRemoveAllTimeSheetEntries","timeSheetId","removeAllTimeSheetEntries","timeSheet","timeSheetEntries","onSubmit","timesheet","id","timeSheetDate","status","statusChangedDate","changeTimeSheetStatus","alert","onClickAddTimesheetEntry","showaddTimesheetEntry","onCloseAddPopup","onClickUpdateTimesheetEntry","timeSheetEntry","newentry","selectedTimeSheetEntrytoUpdate","showupdateTimesheetEntry","onCloseUpdatePopup","undefined","date","getTimeSheet","insertTimeSheet","totalminutes","forEach","entry","getDurationOfWork","durationInMinutes","convertMinutesintoHours","onAddStateChange","isupdated","onUpdateStateChange","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Transflower\\TFLPortal\\WebSolution\\PMSNGApp\\src\\app\\time-sheet\\components\\forms\\insert-time-sheet\\insert-time-sheet.component.html","C:\\Transflower\\TFLPortal\\WebSolution\\PMSNGApp\\src\\app\\time-sheet\\components\\forms\\insert-time-sheet\\insert-time-sheet.component.ts"],"sourcesContent":["<ng-template #insertTimesheetEnrty>\r\n    <app-insert-time-sheet-entry *ngIf=\"timeSheet\" [timeSheetId]=\"timeSheet.id\"\r\n        (stateChangeEvent)=\"onAddStateChange($event)\"></app-insert-time-sheet-entry>\r\n</ng-template>\r\n\r\n<ng-template #updateTimeSheetEntry>\r\n    <app-update-timesheet-entry *ngIf=\"selectedTimeSheetEntrytoUpdate\" [timeSheetEntry]=\"selectedTimeSheetEntrytoUpdate\"\r\n        (stateChangeEvent)=\"onUpdateStateChange($event)\"></app-update-timesheet-entry>\r\n</ng-template>\r\n\r\n<app-popup *ngIf=\"showaddTimesheetEntry\" [templateToRender]=\"insertTimesheetEnrty\"\r\n    (closePopup)=\"onCloseAddPopup()\"></app-popup>\r\n\r\n<app-popup *ngIf=\"showupdateTimesheetEntry\" [templateToRender]=\"updateTimeSheetEntry\"\r\n    (closePopup)=\"onCloseUpdatePopup()\"></app-popup>\r\n\r\n\r\n<p> Date : {{timeSheet?.timeSheetDate |date}}</p>\r\n<p> Status:{{timeSheet?.status |titlecase}}</p>\r\n<p> Employee Name:{{timeSheet?.employeeName}}</p>\r\n<button *ngIf=\"timeSheet?.status=='inprogress'\" (click)=\"onClickAddTimesheetEntry()\"> Add </button>\r\n\r\n<table class=\"table-bordered\">\r\n    <thead>\r\n        <tr>\r\n            <th>Category</th>\r\n            <th>work</th>\r\n            <th>StartTime</th>\r\n            <th>EndTime</th>\r\n            <th>Duration</th>\r\n        </tr>\r\n    </thead>\r\n    <tbody *ngFor=\"let timeSheetEntry of timeSheet?.timeSheetEntries\">\r\n        <tr>\r\n            <td>{{timeSheetEntry.workCategory }}</td>\r\n            <td>{{timeSheetEntry.work }}</td>\r\n            <td>{{timeSheetEntry.fromTime }}</td>\r\n            <td>{{timeSheetEntry.toTime}}</td>\r\n            <td>{{timeSheetEntry.durationInHours}}</td>\r\n            <td *ngIf=\"timeSheet?.status=='inprogress'\"><button\r\n                    (click)=\"onClickUpdateTimesheetEntry(timeSheetEntry)\">Edit</button></td>\r\n            <td *ngIf=\"timeSheet?.status=='inprogress'\"><button\r\n                    (click)=\"onRemoveTimeSheetEntry(timeSheetEntry.id)\">Delete</button></td>\r\n        </tr>\r\n\r\n    </tbody>\r\n\r\n</table>\r\n\r\n<p>Total Hours : {{totalminutes}}</p>\r\n\r\n<button type=\"submit\" *ngIf=\"timeSheet?.status=='inprogress'\" (click)=\"onSubmit()\"> submit </button>\r\n<button class=\"mx-1\" *ngIf=\"timeSheet?.status=='inprogress ' && timeSheet\" (click)=\"onRemoveAllTimeSheetEntries(timeSheet.id)\">\r\n    ClearAll </button>","import { Component, OnInit } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { TimeSheet } from 'src/app/time-sheet/models/timesheet';\r\nimport { TimesheetEmployee } from 'src/app/time-sheet/models/timesheet-employee';\r\nimport { TimeSheetEntry } from 'src/app/time-sheet/models/timesheetentry';\r\n\r\nimport { TimeSheetService } from 'src/app/time-sheet/services/time-sheet.service';\r\n\r\n@Component({\r\n  selector: 'app-insert-time-sheet',\r\n  templateUrl: './insert-time-sheet.component.html',\r\n  styleUrls: ['./insert-time-sheet.component.css'],\r\n})\r\nexport class InsertTimeSheetComponent implements OnInit {\r\n  // timeSheetId!: number;\r\n  // timeSheetEntries: TimeSheetEntry[] = [];\r\n  totalminutes: any = 0;\r\n  showaddTimesheetEntry: boolean = false;\r\n  showupdateTimesheetEntry: boolean = false;\r\n  todaysDate: string = new Date().toISOString().slice(0, 10);\r\n  employeeId = 10;\r\n  timeSheet: TimesheetEmployee | undefined;\r\n  selectedTimeSheetEntrytoUpdate: TimeSheetEntry | undefined;\r\n\r\n  constructor(private timeSheetSvc: TimeSheetService) {}\r\n  ngOnInit(): void {\r\n    this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\r\n  }\r\n\r\n  onRemoveTimeSheetEntry(timeSheetEntryId: number) {\r\n    this.timeSheetSvc\r\n      .removeTimeSheetEntry(timeSheetEntryId)\r\n      .subscribe((res) => {\r\n        if (res) {\r\n          this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\r\n          console.log('record deleted');\r\n        }\r\n      });\r\n  }\r\n\r\n  onRemoveAllTimeSheetEntries(timeSheetId: number) {\r\n    this.timeSheetSvc\r\n      .removeAllTimeSheetEntries(timeSheetId)\r\n      .subscribe((res) => {\r\n        if (res) {\r\n          if (this.timeSheet) this.timeSheet.timeSheetEntries = [];\r\n        }\r\n      });\r\n  }\r\n\r\n  onSubmit() {\r\n    if (this.timeSheet) {\r\n      let timesheet: TimeSheet = {\r\n        id: this.timeSheet?.id,\r\n        timeSheetDate: this.timeSheet.timeSheetDate ,\r\n        status: 'Submitted',\r\n        employeeId: this.timeSheet.employeeId,\r\n        timeSheetEntries: this.timeSheet.timeSheetEntries,\r\n        statusChangedDate: this.todaysDate,\r\n      };\r\n\r\n      this.timeSheetSvc\r\n        .changeTimeSheetStatus(this.timeSheet.id, timesheet)\r\n        .subscribe((res) => {\r\n          alert('timesheet added');\r\n        });\r\n    }\r\n  }\r\n\r\n  onClickAddTimesheetEntry() {\r\n    this.showaddTimesheetEntry = true;\r\n  }\r\n  onCloseAddPopup() {\r\n    this.showaddTimesheetEntry = false;\r\n  }\r\n\r\n  onClickUpdateTimesheetEntry(timeSheetEntry: TimeSheetEntry) {\r\n    let newentry = { ...timeSheetEntry };\r\n    this.selectedTimeSheetEntrytoUpdate = newentry;\r\n    this.showupdateTimesheetEntry = true;\r\n  }\r\n\r\n  onCloseUpdatePopup() {\r\n    this.showupdateTimesheetEntry = false;\r\n    this.selectedTimeSheetEntrytoUpdate = undefined;\r\n  }\r\n\r\n  fetchTimeSheetEntries(employeeId: number, date: string) {\r\n    this.timeSheetSvc.getTimeSheet(employeeId, date).subscribe((res) => {\r\n      if (res.id == 0) {\r\n        this.timeSheetSvc.insertTimeSheet(employeeId, date).subscribe((res) => {\r\n          if (res) {\r\n            this.fetchTimeSheetEntries(employeeId, date);\r\n          }\r\n        });\r\n        return;\r\n      }\r\n\r\n      this.totalminutes = 0;\r\n      this.timeSheet = res;\r\n\r\n      console.log('🚀 ~ this.timeSheetSvc.getTimeSheet ~ timeSheetId:', res.id);\r\n\r\n      this.timeSheet.timeSheetEntries.forEach((entry) => {\r\n        entry = this.timeSheetSvc.getDurationOfWork(entry);\r\n        this.totalminutes += entry.durationInMinutes;\r\n      });\r\n      this.totalminutes = this.timeSheetSvc.convertMinutesintoHours(\r\n        this.totalminutes\r\n      );\r\n\r\n      console.log(res);\r\n    });\r\n  }\r\n\r\n  onAddStateChange(isupdated: boolean) {\r\n    if (isupdated) {\r\n      this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\r\n    }\r\n    this.showaddTimesheetEntry = false;\r\n  }\r\n\r\n  onUpdateStateChange(isupdated: boolean) {\r\n    if (isupdated) {\r\n      this.fetchTimeSheetEntries(this.employeeId, this.todaysDate);\r\n    }\r\n    this.showupdateTimesheetEntry = false;\r\n    this.selectedTimeSheetEntrytoUpdate = undefined;\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}